<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  <meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: gap: content:">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#2196f3">
  <!-- Your app title -->
  <title>My App</title>
  <!-- Path to Framework7 Library CSS -->
  <link rel="stylesheet" type="text/css" href="css/framework7.min.css">
  <link rel="stylesheet" type="text/css" href="css/framework7-icons.css">
  <!-- Path to your custom app styles-->
  <link rel="stylesheet" type="text/css" href="css/app.css">
</head>

<body>
  <div id="app">
    <div class="statusbar"></div>
    <div class="view view-main">
      <div class="page no-navbar no-toolbar no-swipeback">
        <div id="container" class="page-content login-screen-content"></div>
      </div>
    </div>
  </div>
  <script type="text/javascript" src="js/framework7.min.js"></script>
  <script src="js/routes.js"></script>
  <script type="text/javascript" src="js/app.js"></script>
  <script type="text/babel">
  
      class Meme extends React.Component{
      constructor(props){
          super(props);
          this.state = {
              username: "",
              password: ""
          }
      }

      componentDidMount() {
         let pagecontent = document.getElementsByClassName("page-content login-screen-content")[0];
         pagecontent.style = "background-image: url('assets/background2.png');background-position: center;background-repeat: no-repeat;background-size: cover; display: flex; justify-content: center; align-items: center;";
      }
    
      fetchData = () => {
          var isUser = null;
          var isAdmin = null;

          var user = fetch(`https://stormy-coast-58891.herokuapp.com/user_login?username=${this.state.username}&password=${this.state.password}`)
          .then(response => response.json())
          .then(response => {if(response.length == 1){isUser = true; app.views.main.router.navigate('/categories/'); console.log("Logged in as: " + response[0].User_Username); fetchCategories(response[0].User_ID);}else if(response.length == 0){isUser = false;}})
          .catch(err => console.error(err))

          var admin = fetch(`https://stormy-coast-58891.herokuapp.com/admin_login?username=${this.state.username}&password=${this.state.password}`)
          .then(response => response.json())
          .then(response => {if(response.length == 1){isAdmin = true; app.views.main.router.navigate('/categories/'); test();} else if(response.length == 0){isAdmin = false;}})
          .catch(err => console.error(err))

          Promise.all([user,admin]).then(function(){if(isUser == null || isAdmin == null){app.dialog.alert("Unable to connect with server.Â­", "Connection timed out ðŸ¤”"); console.log("Connection to the server failed has failed! Error: 404")} else if(!isUser && !isAdmin){app.dialog.alert("Incorrect username and/or password. Please try again! ðŸ”’Â­", "Login credentials incorrect!");}})
      }
      render(){
      return(
        <div>
          <h1 className="logintitle">Saggezza</h1>
            <form className="list">
              <ul>
                <li>
                  <div className="item-content item-input item-input-with-value">
                    <div className="item-inner">
                      <div className="item-title item-label">Username</div>
                      <div className="item-input-wrap">
                          <input type="text" name="username" placeholder="Your username" value={this.state.username} onChange= {event => this.setState({username : event.target.value})} />
                        </div>
                        </div>
                        </div>
                        </li>
                        <li>
                          <div className="item-content item-input item-input-with-value">
                            <div className="item-inner">
                              <div className="item-title item-label">Password</div>
                              <div className="item-input-wrap">
                                  <input type="password" name="password" placeholder="Your password" value={this.state.password} onChange= {event => this.setState({password : event.target.value})}/>
                                </div>
                                </div>
                                </div>
                                </li>
                                </ul>
                                </form>
                                <div className="list" style={{width: "90%"}}>
                                  <ul>
                                    <li>
                                      <button type="button" className="list-button text-color-white bg-color-green" onClick={this.fetchData}>Login</button>
                                      </li></ul><div style={{paddingTop: "25px", textAlign: "center"}}>
                                        <div style={{display: "inline-block"}}>
                                          <button className="loginBtn loginBtn--facebook">Login with Facebook</button>
                                          </div>
                                          <br />
                                          <div style={{display: "inline-block"}}>
                                            <button className="loginBtn loginBtn--google">Login with Google</button>
                                          </div></div></div></div>
      );
      }
      }
      
      ReactDOM.render( 
      <div style={{width: "85%", maxWidth: "600px"}}>
      <Meme />
      </div>,
      document.querySelector("#container") 
      );
      </script>
</body>
â€‹

</html>